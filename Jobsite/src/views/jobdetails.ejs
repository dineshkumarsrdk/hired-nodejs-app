<div id="job-details" class="d-flex flex-column justify-content-evenly align-items-center border rounded-3 bg-light"> 
    <div style="font-size: 3rem; font-family:Cambria, Cochin, Georgia">
        <span class="text-danger"><%= job.designation %></span><span class="text-success"> oppertunity at </span><span class="text-info"><%= job.companyName %></span>
    </div> 
    <div class="d-flex justify-content-evenly align-items-center" style="width: 100%;">
        <div class="d-flex flex-column justify-content-evenly align-items-start mx-4" style="width: 50%;">
            <h3 class="fw-bold"><%= job.companyName %></h3>
            <div>
                <span><%= job.category %></span>
                <span class="text-warning"><%= job.designation %></span>
            </div>
            <div class="d-flex flex-column justify-content-center align-items-start p-2">
                <span><i class="fa-solid fa-location-dot"></i> <%= job.location %></span>
                <span><i class="fa-solid fa-indian-rupee-sign"></i> CTC: <%= job.salary %></span>
                <span><i class="fa-regular fa-hourglass-half"></i> Apply By: <%= job.deadline %></span>
                <span><i class="fa-solid fa-hashtag"></i> Number of openings: <%= job.openings %></span>
                <% if(locals.userName){ %>
                    <a href="#" data-bs-toggle="modal" 
                    data-bs-target="#applicantDetails" style="text-decoration: none; color: black;"><i class="fa-solid fa-users"></i><span class="text-danger"> Applicants: <%= job.applicants.length %></span></a>
                <% } else { %>
                    <span><i class="fa-solid fa-users"></i> Applicants: <%= job.applicants.length %></span>
                <% } %>
            </div>
            <div class="skills">
                <% job.skills.forEach(skill => { %>
                    <button class="btn btn-sm btn-outline-info mx-1 my-1"><%= skill %></button>
                <% }) %>
            </div>
            <small class="bg-success text-white border border-success p-2 rounded">Posted on: <%= job.postedDate %></small>
        </div>
        <div class="d-flex flex-column justify-content-start align-items-end mx-4" style="width: 50%; height: 100%; font-family: 'Segoe UI', Tahoma, Geneva;">
            <a href="#" data-bs-toggle="modal" 
            data-bs-target="#applyJob" class="btn btn-primary mb-2 w-25">Apply now</a>
            <% if(locals.userName){ %>
                <a href="#" data-bs-toggle="modal" 
                    data-bs-target="#updateJob" class="btn btn-warning mb-2 w-25">Update job</a>
                <a id="deleteJob" href="/jobs/<%= job.id %>/delete" class="btn btn-danger mb-2 w-25">Delete job</a>
            <% } %>
        </div>
    </div>
</div>
<!-- Modal for applying to a job -->
<div class="modal fade" id="applyJob" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Apply in less than 1 minute</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="/jobs/<%= job.id %>/apply" method="post" enctype="multipart/form-data">
                    <div class="mb-2">
                        <label class="form-label my-2" for="name">Name</label>
                        <input required class="form-control" type="text" name="name" id="name">
                    </div>
                    <div class="mb-2">
                        <label class="form-label my-2" for="email">Email</label>
                        <input required class="form-control" type="email" name="email" id="email">
                    </div>
                    <div class="mb-2">
                        <label class="form-label my-2" for="contact">Mobile number</label>
                        <input required class="form-control" type="tel" name="contact" id="contact">
                    </div> 
                    <div class="mb-2">
                        <label class="form-label my-2" for="resume">Resume</label>
                        <input required class="form-control" type="file" accept=".pdf" name="resume" id="resume">
                    </div>
                    <button type="submit" class="btn btn-success w-100">Apply</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal for updating the job details -->
<div class="modal fade" id="updateJob" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Update job details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="/jobs/<%= job.id %>/update" method="post">
                    <div class="mb-2">
                        <select required name="category" class="form-select">
                            <option selected disabled value="">Select job category</option>
                            <option value="Tech">Tech</option>
                            <option value="Non-Tech">Non-Tech</option>
                        </select>
                    </div>
                    <div class="mb-2">
                        <select required name="designation" class="form-select">
                            <option selected disabled value="">Select job role</option>
                            <option value="SDE-I">SDE-I</option>
                            <option value="SDE-II">SDE-II</option>
                            <option value="MERN Stack developer">MERN Stack developer</option>
                            <option value="MEAN Stack developer">MEAN Stack developer</option>
                            <option value="DevOps">DevOps</option>
                            <option value="Java developer">Java developer</option>
                            <option value="Python developer">Python developer</option>
                        </select>
                    </div>
                    <div class="mb-2">
                        <label class="form-label my-2" for="location">Enter job location</label>
                        <input required class="form-control" type="text" name="location" id="location"
                        value="<%= job.location %>">
                    </div>
                    <div class="mb-2">
                        <label class="form-label my-2" for="companyName">Company name</label>
                        <input required class="form-control" type="text" name="companyName" id="companyName"
                        value="<%= job.companyName %>">
                    </div>
                    <div class="mb-2">
                        <label class="form-label my-2" for="salary">Enter salary range</label>
                        <input required class="form-control" type="text" name="salary" id="salary" placeholder="6-7LPA"
                        value="<%= job.salary %>">
                    </div> 
                    <div class="mb-2">
                        <label class="form-label my-2" for="openings">Total openings</label>
                        <input required class="form-control" type="number" name="openings" id="openings"
                        value="<%= job.openings %>">
                    </div>
                    <div class="mb-2">
                        <label class="form-label my-2" for="skills">Enter required skills</label>
                        <input required class="form-control" type="text" name="skills" id="skills" placeholder="Java, Springboot etc"
                        value="<%= job.skills.toString() %>">
                    </div>
                    <div class="mb-2">
                        <label class="form-label my-2" for="deadline">Select application deadline</label>
                        <input required class="form-control" type="date" name="deadline" id="deadline">
                    </div>
                    <button id="updateJobBtn" type="submit" class="btn btn-success w-100">Update job</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal for viewing applicants -->
<div class="modal fade" id="applicantDetails" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Applicants details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <table class="table table-stripped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Contact</th>
                            <th>Resume</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% job.applicants.forEach((applicant, index) =>{ %>
                            <tr>
                                <td><%= index+1 %></td>
                                <td><%= applicant.name %></td>
                                <td><%= applicant.email %></td>
                                <td><%= applicant.contact %></td>
                                <td><a href="<%= applicant.resume %>" class="btn btn-sm btn-primary" target="_blank">View</a></td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>